import json
import os

FILE_NAME = "tasks.json"
todos = []

# ƒê·ªçc d·ªØ li·ªáu t·ª´ file khi kh·ªüi ƒë·ªông
def load_tasks():
    global todos
    if os.path.exists(FILE_NAME):
        with open(FILE_NAME, "r", encoding="utf-8") as f:
            todos = json.load(f)
    else:
        todos = []

# L∆∞u d·ªØ li·ªáu v√†o file sau m·ªói thay ƒë·ªïi
def save_tasks():
    with open(FILE_NAME, "w", encoding="utf-8") as f:
        json.dump(todos, f, ensure_ascii=False, indent=4)

def show_menu():
    print("\n=== TODO APP ===")
    print("1. Th√™m c√¥ng vi·ªác")
    print("2. X√≥a c√¥ng vi·ªác")
    print("3. ƒê√°nh d·∫•u ho√†n th√†nh")
    print("4. Hi·ªÉn th·ªã danh s√°ch")
    print("5. Tho√°t")

def add_task():
    task = input("Nh·∫≠p c√¥ng vi·ªác m·ªõi: ")
    todos.append({"task": task, "done": False})
    save_tasks()
    print("‚úÖ ƒê√£ th√™m c√¥ng vi·ªác!")

def delete_task():
    show_tasks()
    try:
        index = int(input("Nh·∫≠p s·ªë th·ª© t·ª± c√¥ng vi·ªác c·∫ßn x√≥a: ")) - 1
        if 0 <= index < len(todos):
            removed = todos.pop(index)
            save_tasks()
            print(f"üóëÔ∏è ƒê√£ x√≥a: {removed['task']}")
        else:
            print("‚ùå S·ªë th·ª© t·ª± kh√¥ng h·ª£p l·ªá.")
    except ValueError:
        print("‚ùå Vui l√≤ng nh·∫≠p s·ªë.")

def mark_done():
    show_tasks()
    try:
        index = int(input("Nh·∫≠p s·ªë th·ª© t·ª± c√¥ng vi·ªác ƒë√£ ho√†n th√†nh: ")) - 1
        if 0 <= index < len(todos):
            todos[index]["done"] = True
            save_tasks()
            print(f"‚úîÔ∏è ƒê√£ ho√†n th√†nh: {todos[index]['task']}")
        else:
            print("‚ùå S·ªë th·ª© t·ª± kh√¥ng h·ª£p l·ªá.")
    except ValueError:
        print("‚ùå Vui l√≤ng nh·∫≠p s·ªë.")

def show_tasks():
    if not todos:
        print("üì≠ Danh s√°ch c√¥ng vi·ªác tr·ªëng.")
    else:
        print("\nüìã Danh s√°ch c√¥ng vi·ªác:")
        for i, todo in enumerate(todos, start=1):
            status = "‚úîÔ∏è" if todo["done"] else "‚è≥"
            print(f"{i}. {todo['task']} {status}")

# Ch·∫°y ·ª©ng d·ª•ng
load_tasks()
while True:
    show_menu()
    choice = input("Ch·ªçn ch·ª©c nƒÉng (1-5): ")
    if choice == "1":
        add_task()
    elif choice == "2":
        delete_task()
    elif choice == "3":
        mark_done()
    elif choice == "4":
        show_tasks()
    elif choice == "5":
        print("üëã Tho√°t ·ª©ng d·ª•ng. H·∫πn g·∫∑p l·∫°i!")
        break
    else:
        print("‚ùå L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá, vui l√≤ng th·ª≠ l·∫°i.")
